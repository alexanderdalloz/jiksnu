{namespace jiksnu.templates.activity}

/**
 * @param authenticated
 */
{template .addForm}
  <div>
    {if $authenticated}
      {call .activityForm data="all" /}
    {/if}
  </div>
{/template}


/**
 * @param uri
 */
{template .commentLink}
  <a href="{$uri}">Comment</a>
{/template}


/**
 * @param comments
 */
{template .commentsSection}
  {if $comments}

  {/if}
{/template}

/**
 * @param uri
 */
{template .deleteButton}
  <form method="delete"
        action="{$uri}">
    <input type="submit" value="Delete" />
  </form>
{/template}


/**
 * @param lat
 * @param long
 */
{template .displayMap}
  {if $lat and $long}
    <img src="https://maps.googleapis.com/maps/api/staticmap?size=200x200&zoom=11&sensor=true&markers=color:red|{$lat},{$long}"
         class="map" />
  {/if}
{/template}


/**
 * @param uri
 */
{template .editButton}
  <form method="post"
        action="{$uri}/edit">
    <input type="submit" value="Edit" />
  </form>
{/template}


/**
 * @param uri
 */
{template .fetchCommentButton}
  <form method="post"
        action="{$uri}/comments/update">
    <input type="submit" value="Update" />
  </form>
{/template}


/**
 * @param activities
 */
{template .indexBlock}
  <div id="notices_primary">
    <ol class="activities">
      {foreach $activity in $activities}
        {call .show data="$activity" /}
      {/foreach}
    </ol>
  </div>
{/template}

/**
 * @param activities
 */
{template .indexBlockMinimal}
  <ol class="activities">
    {foreach $activity in $activities}
      <li>
        {call .show data="$activity" /}
      </li>
    {/foreach}
  </ol>
{/template}


/**
 * @param uri
 */
{template .likeButton}
  <form method="post"
        action="{$uri}/comments/post">
    <input type="submit" value="Fetch Comments" />
  </form>
{/template}


/**
 * @param links
 * @param object_type
 */
{template .linkSection }
  {if $links}
    <div class="{css links}">
      <h>Links</h>
      <ul>
        {foreach $link in $links}
          <li>
            <p>Href: {$link.href}</p>
            <p>Rel: {$link.rel}</p>
            <p>Title: {$link.title}</p>
            <p>Mime Type: {$link.mime_type}</p>
            {if $object_type == 'picture'}
              <img src="{$link.href}"
                   width="100"
                   height="100"/>
            {/if}
          </li>
        {/foreach}
      </ul>
    </div>
  {/if}
{/template}


/**
 * @param recipients
 */
{template .recipientSection}
  {if $recipients}
    <div class="{css recipients}">
      <h>Recipients:</h>
      <ul>
        {foreach $recipient in $recipients}
          <li>
            {call .linkTo data="all" /}
          </li>
        {/foreach}
      </ul>
    </div>
  {/if}
{/template}


/**
 * Display an activity
 * @param id
 * @param authors
 * @param content
 * @param object_type
 * @param local
 * @param public
 * @param title
 * @param lat
 * @param long
 * @param uri
 * @param published
 * @param comment_count
 * @param buttonable
 * @param comments
 */
{template .show}
  <article class="{css hentry} {css notice}"
           id="{$id}">
    <header class="{css avatar-section}">
      {foreach $user in $authors}
        {call jiksnu.templates.user.displayAvatar data="$user" /}
      {/foreach}
    </header>
    <section class="{css content}">
      <header>
        {foreach $user in $authors}
          {call jiksnu.templates.user.showMinimal data="$user" /}
        {/foreach}
        {if $object_type != 'comment'}
          <div class="{css labels}">
            <span id="{css local}">{if not $local} remote{/if}</span>
            <span id="{css privacy}">{if not $public} private{/if}</span>
          </div>
        {/if}
      </header>
      <p class="{css entry-content}">
        {if $object_type == 'article' and $title}
          <h3 class="{css entry-title}">{$title}</h3>
        {/if}
      </p>
      <div>
        {$content}
      </div>
      {call .linkSection /}
      <div>
        {if $lat}
          <p>Lat: {$lat}</p>
        {/if}
        {if $long}
          <p>Long: {$long}</p>
        {/if}
        {call .displayMap data="all" /}
      </div>
      {call .tagsSection data="all" /}
      <footer>
        {if $published}
          <p>
            <a href="/notice/{$id}">
              <time>
                {if $published}
                  {$published}
                {else}
                  Unknown
                {/if}
              </time>
            </a>
          </p>
        {/if}
        <ul class="{css buttons}">
          {if $buttonable}
            <li>{call .likeButton data="all" /}</li>
            <li>{call .editButton data="all" /}</li>
            <li>{call .deleteButton data="all" /}</li>
          {/if}
        </ul>
        <div class="{css comments}">
          <p>
            <span>Comments: {$comment_count}</span>
            {sp}
            <a href="#">Show</a>
            {sp}
            {call .commentLink data="all" /}
            {sp}
            /* {call .fetchCommentsButton data="all" /} */
          </p>
          {if $comments}
            {call .commentsSection data="all" /}
          {/if}
        </div>
      </footer>
    </section>
  </article>
{/template}


/**
 * @param tags
 */
{template .tagsSection}
  <div class="{css tags}">
    <h>Tags:</h>
    <ul>
      {foreach $tag in $tags}
        <li>
          <a href="#{$tag}"
             rel="tag">{$tag}</a>
        </li>
      {/foreach}
    </ul>
  </div>
{/template}
